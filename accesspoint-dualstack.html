<!DOCTYPE html>
<html lang="es">

<head>
  <link rel="stylesheet/less" type="text/css" href="./theme/css/style.less">
  <script src="./theme/js/less-1.3.3.min.js" type="text/javascript"></script>
  <!-- <link rel="stylesheet" type="text/css" href="./theme/css/style.css"> -->

  <link rel="stylesheet" type="text/css" href="./theme/css/pygments.css">
  <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width; initial-scale=1.0">
  <meta name="author" content="">
  <meta name="description" content="Posts and writings by ">

    <link href="http://www.netbsd.mx/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Grupo de Usuarios de NetBSD en México Full Atom Feed" />
      <link href="http://www.netbsd.mx/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Grupo de Usuarios de NetBSD en México Full RSS Feed" />
  
  <meta name="keywords" content="netbsd, redes, wireless">

  <title>
    Access point con doble stack y seguridad WPA  </title>

  </head>

<body>
  <aside>
    <div id="user_meta">
      <a href=".">
                <img src="./theme/images/logo.png" alt="logo">
              </a>
      <h2><a href="."></a></h2>
      <p></p>
      <ul>
                                <li><a href="http://www.netbsd.org" target="_blank">NetBSD</a></li>
                        <li><a href="http://twitter.com/netbsdmx" target="_blank">twitter</a></li>
              </ul>
    </div>
  </aside>

  <main>
    <header>
      <p>Posted on Tuesday, 02 de July de 2013</p>
    </header>

    <article>
  <div id="article_title">
    <h3><a href="./accesspoint-dualstack.html">Access point con doble stack y seguridad WPA</a></h3>
  </div>
  <div id="article_text">
    <div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#descripcion" id="id1">Descripcion</a></li>
<li><a class="reference internal" href="#definiciones" id="id2">Definiciones:</a></li>
<li><a class="reference internal" href="#requisitos" id="id3">Requisitos:</a></li>
<li><a class="reference internal" href="#procedimiento" id="id4">Procedimiento:</a></li>
<li><a class="reference internal" href="#cliente" id="id5">Cliente:</a></li>
<li><a class="reference internal" href="#comentarios-y-explicaciones" id="id6">Comentarios y explicaciones:</a></li>
</ul>
</div>
<div class="section" id="descripcion">
<h2><a class="toc-backref" href="#id1">Descripcion</a></h2>
<p>Este Access Point operando bajo NetBSD con llaves dinámicas WPA es
extremadamente seguro. Las razones de ello no podría explicarlas porque
esa no es mi área de conocimiento... tendrá qué buscarlas usted por su
cuenta. Si usted es un paranoico de la seguridad, esta configuración de
Access Point es para usted.</p>
</div>
<div class="section" id="definiciones">
<h2><a class="toc-backref" href="#id2">Definiciones:</a></h2>
<ul class="simple">
<li>La tarjeta de red es la CNet <strong>CWP-854</strong> PCI con chipset
RT2501/RT2561N driver <strong>ral(4)</strong></li>
<li>Se utilizará una llave de 512 bits (64 bytes)</li>
<li>Se utlizará la red privada 192.168.154.0/24</li>
<li>Se utlizará la red IPv6 3ffe:8240:8018:7fa::/64</li>
<li>Las direcciones de nuestra tarjeta inalámbrica serán 192.168.154.1 y
3ffe:8240:8018:7fa::1</li>
<li>Nuestra red inalámbrica se llamará <strong>hola</strong></li>
<li>Utilizaremos el <strong>canal 4</strong> de la red inalámbrica</li>
</ul>
</div>
<div class="section" id="requisitos">
<h2><a class="toc-backref" href="#id3">Requisitos:</a></h2>
<ul class="simple">
<li>Una computadora con NetBSD-4 ó superior</li>
<li>Servicio dhcpd en la misma máquina configurado con las direcciones
previamente definidas</li>
<li>Servicio DNS caché (por lo menos) en la misma máquina</li>
<li>Servicio hostapd</li>
<li>Una llave de 512 bits en formato exadecimal generadas en algún
dispositivo de tipo random</li>
</ul>
</div>
<div class="section" id="procedimiento">
<h2><a class="toc-backref" href="#id4">Procedimiento:</a></h2>
<ul>
<li><p class="first">Instale el hardware y software</p>
</li>
<li><p class="first">Configure el sistema operativo y los requisitos, no olvide el soporte
de IPv6</p>
</li>
<li><p class="first">Elabore el archivo de configuración de la tarjeta inalámbrica</p>
<p><tt class="docutils literal">/etc/ifconfig.ral0</tt></p>
</li>
</ul>
<pre class="literal-block">
nwid&nbsp;hola&nbsp;mediaopt&nbsp;hostap&nbsp;chan&nbsp;4
inet&nbsp;&nbsp;192.168.64.1&nbsp;netmask&nbsp;0xffffff00&nbsp;media&nbsp;auto
inet6&nbsp;3ffe:8240:8018:7fa::1&nbsp;prefixlen&nbsp;64&nbsp;alias
up
</pre>
<ul class="simple">
<li>Haga el archivo <strong>/etc/rtadvd.conf</strong> de anuncio de rutas y asignación
de direcciones de IPv6</li>
</ul>
<blockquote>
<tt class="docutils literal">ral0:\</tt>
<tt class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:addr=&quot;3ffe:8240:8016:aff::&quot;:prefixlen#64:</span></tt></blockquote>
<ul class="simple">
<li>Haga el archivo <strong>/etc/hostapd.conf</strong> para la configuración de la
seguridad</li>
</ul>
<pre class="literal-block">
interface=ral0
logger_syslog=-1
logger_syslog_level=2
logger_stdout=-1
logger_stdout_level=2
debug=0
dump_file=/tmp/hostapd.dump
ctrl_interface=/var/run/hostapd
ctrl_interface_group=wheel
ssid=hola
macaddr_acl=0
auth_algs=1
wpa=1
wpa_psk=75eb38988c5bb4499517c319934c845f6575f0456fa693666e0a90da3b92b740
</pre>
<ul class="simple">
<li>Configure el arranque de los servicios en <strong>/etc/rc.conf</strong></li>
</ul>
<pre class="literal-block">
ip6mode=router
hostapd=YES
rtadvd=YES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtadvd_flags=&quot;ral0&quot;
named=YES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;named_flags=&quot;&quot;
dhcpd=YES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dhcpd_flags=&quot;-q&nbsp;ral0&quot;
</pre>
<p>Reinicie su máquina, la parte de Access Point ha quedado lista.</p>
</div>
<div class="section" id="cliente">
<h2><a class="toc-backref" href="#id5">Cliente:</a></h2>
<ul class="simple">
<li>Configure la interfase inalámbrica del cliente con la red hola y la
llave de 512 bits (wpa_psk)</li>
<li>Reinicie</li>
</ul>
<p>Ahora tiene usted el servicio de Access Point WPA completamente
operacional. Disfrute su nuevo access point :)</p>
</div>
<div class="section" id="comentarios-y-explicaciones">
<h2><a class="toc-backref" href="#id6">Comentarios y explicaciones:</a></h2>
<blockquote>
<tt class="docutils literal">/etc/ifconfig.ral0</tt></blockquote>
<ul class="simple">
<li>hostap es el modo para trabajar como &quot;Access Point&quot;. Otras
opciones son ibss para conexiones peer to peer, <strong>monitor</strong>
(autoexplicativo) y bss (default) para ser cliente de un access
point. Consulte el manual del driver de su tarjeta de red para
comprobar el soporte de estos modos.</li>
<li>Se hacen las asignaciones de direcciónes IP, IPv6 y sus máscaras. La
media elegida es auto para que la tarjeta inalámbrica tome el
valor default de velocidad. Otros valores posibles son DS5,
OFDM54 y varios más. Consulte el manual del driver de su tarjeta
de red para comprobar el soporte de otras velocidades así como sus
alcances y limitaciones.</li>
</ul>
<blockquote>
<tt class="docutils literal">/etc/rtadvd.conf</tt></blockquote>
<ul class="simple">
<li>Con ral0:addr=&quot;3ffe:8240:8018:7fa::&quot;:prefixlen#64: es posible
definirlo en una sola línea acorde a la sintáxis de termcap(5)</li>
<li>El servicio rtadvd con la dirección base addr/64 y la mac address del
cliente que solicita una IPv6 le asignará una dirección utilizando el
formato eui64</li>
</ul>
<blockquote>
<tt class="docutils literal">/etc/rc.conf</tt></blockquote>
<ul class="simple">
<li>Ponemos nuestra máquina con NetBSD en modo de ruteo IPv6</li>
<li>Declaramos que los cuatro servicios arrancarán en automático. Las
flags con ral0 indican que el servicio solo correrá en esa interfase.</li>
</ul>
<blockquote>
<tt class="docutils literal">/etc/hostapd.conf</tt></blockquote>
<ul class="simple">
<li>El archivo proporcionado está a su mínima expresión, con valores por
default y sin comentarios.</li>
<li>Si usted desea tener este archivo completo y con sus comentarios,
haga lo siguiente:</li>
</ul>
<p><tt class="docutils literal"><span class="pre">cp&nbsp;/usr/share/examples/hostapd/hostapd.conf&nbsp;/etc/hostapd.conf</span></tt></p>
<p>Edite su archivo y haga los siguientes reemplazos</p>
<pre class="literal-block">
diff&nbsp;/usr/share/examples/hostapd/hostapd.conf&nbsp;/etc/hostapd.conf
1c1
&lt;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$NetBSD:&nbsp;hostapd.conf,v&nbsp;1.1&nbsp;2006/04/30&nbsp;13:52:35&nbsp;rpaulo&nbsp;Exp&nbsp;$
---
&gt;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$NetBSD:&nbsp;hostapd.conf&nbsp;1.1&nbsp;2006/04/30&nbsp;13:52:35&nbsp;rpaulo&nbsp;Exp&nbsp;$
8c8
&lt;&nbsp;interface=if0
---
&gt;&nbsp;interface=ral0
70c70
&lt;&nbsp;ssid=NetBSD
---
&gt;&nbsp;ssid=hola
90c90
&lt;&nbsp;auth_algs=3
---
&gt;&nbsp;auth_algs=1
268c268
&lt;&nbsp;#wpa=1
---
&gt;&nbsp;wpa=1
276c276
&lt;&nbsp;#wpa_psk=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
---
&gt;wpa_psk=75eb38988c5bb4499517c319934c845f6575f0456fa693666e0a90da3b92b740
</pre>
<p>Si usted no quiere IPv6, suprima las líneas que lo relacionan, pero no
lo eche en saco roto. <strong>IPv6 ya es inminente</strong>.</p>
<p>Disfrute su nuevo Access Point con NetBSD</p>
</div>

  </div>
  <div id="article_meta">
    <p>Category: <a href="./category/netbsd.html">NetBSD</a></p>
        <p>Tags:
            <a href="./tag/netbsd.html">netbsd</a>,            <a href="./tag/redes.html">redes</a>,            <a href="./tag/wireless.html">wireless</a>          </p>
      </div>
</article>

    <footer>
      <p><a href="./" class="button_accent">&larr; Back to Index</a></p>
    </footer>

    <div id="ending_message">
      <p>&copy Giulio Fidente. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. You can fork the theme on <a href="https://github.com/giulivo/pelican-svbhack" target="_blank">github</a>.</p>
    </div>
  </main>
</body>
</html>